
-- Metadata
meta.id = "Test.Network"
meta.name = "Test Network Library"
meta.author = "Test"

actions.google = function ()
	local http = libs.net.http();
	local resp = http:request({
		method = "get", 
		url = "https://www.google.com/"
	});
	
	libs.server.update({ id="info", text=resp.status });
end

actions.http = function ()
	local http = libs.net.http();
	local resp = http:request({
		method = "get", 
		url = "http://data.wien.gv.at/daten/wfs?service=WFS&request=GetFeature&version=1.1.0&typeName=ogdwien:BAUMOGD&srsName=EPSG:4326&outputFormat=json&maxfeatures=5",
	});
	
	libs.server.update({ id="info", text=resp.content });
end

actions.https = function ()
	local http = libs.net.http();
	local resp = http:request({
		method = "get", 
		url = "https://embed.spotify.com/?uri=spotify:user:phb5000:playlist:60WGD1OLz5tU9KLvnhjHNQ",
	});
	
	libs.server.update({ id="info", text=resp.content });
end

actions.twice = function ()
	local http = libs.net.http();
	local resp1 = http:request({
		method = "get",
		url = "http://www.google.com"
	});
	local resp2 = http:request({
		method = "get",
		url = "http://www.google.com"
	});
	libs.server.update({ id="info", text=resp1.content .. resp2.content });
end

actions.image = function ()
	local http = libs.net.http();
	local resp = http:request({
		method = "get",
		url = "http://nuclearpixel.com/content/icons/2010-02-09_stellar_icons_from_space_from_2005/earth_128.png"
	});
	
	local file = io.open("C:\\test.png", "wb");
    file:write(resp.content);
    file:close();
	
	libs.server.update("file", "image", "C:\\test.png");
	libs.server.update("binary", "image", resp.content);
end